(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2a0a5942"],{1276:function(e,t,n){"use strict";var r=n("d784"),i=n("44e7"),a=n("825a"),s=n("1d80"),o=n("4840"),l=n("8aa5"),c=n("50c4"),u=n("14c3"),d=n("9263"),p=n("d039"),f=[].push,g=Math.min,m=4294967295,y=!p((function(){return!RegExp(m,"y")}));r("split",2,(function(e,t,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var r=String(s(this)),a=void 0===n?m:n>>>0;if(0===a)return[];if(void 0===e)return[r];if(!i(e))return t.call(r,e,a);var o,l,c,u=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),g=0,y=new RegExp(e.source,p+"g");while(o=d.call(y,r)){if(l=y.lastIndex,l>g&&(u.push(r.slice(g,o.index)),o.length>1&&o.index<r.length&&f.apply(u,o.slice(1)),c=o[0].length,g=l,u.length>=a))break;y.lastIndex===o.index&&y.lastIndex++}return g===r.length?!c&&y.test("")||u.push(""):u.push(r.slice(g)),u.length>a?u.slice(0,a):u}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:t.call(this,e,n)}:t,[function(t,n){var i=s(this),a=void 0==t?void 0:t[e];return void 0!==a?a.call(t,i,n):r.call(String(i),t,n)},function(e,i){var s=n(r,e,this,i,r!==t);if(s.done)return s.value;var d=a(e),p=String(this),f=o(d,RegExp),h=d.unicode,v=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(y?"y":"g"),k=new f(y?d:"^(?:"+d.source+")",v),b=void 0===i?m:i>>>0;if(0===b)return[];if(0===p.length)return null===u(k,p)?[p]:[];var x=0,I=0,w=[];while(I<p.length){k.lastIndex=y?I:0;var F,C=u(k,y?p:p.slice(I));if(null===C||(F=g(c(k.lastIndex+(y?0:I)),p.length))===x)I=l(p,I,h);else{if(w.push(p.slice(x,I)),w.length===b)return w;for(var R=1;R<=C.length-1;R++)if(w.push(C[R]),w.length===b)return w;I=x=F}}return w.push(p.slice(x)),w}]}),!y)},"261c":function(e,t,n){e.exports=n.p+"img/05.85fbf262.png"},"44e7":function(e,t,n){var r=n("861d"),i=n("c6b6"),a=n("b622"),s=a("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[s])?!!t:"RegExp"==i(e))}},"61a4":function(e,t,n){e.exports=n.p+"img/04.5da00249.png"},"6e8b":function(e,t,n){e.exports=n.p+"img/03.da1dafe2.png"},7707:function(e,t,n){"use strict";var r=n("87b2"),i=n.n(r);i.a},"87b2":function(e,t,n){},c3da:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"keyInfo",staticStyle:{"min-width":"900px"}},[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),r("el-breadcrumb-item",[e._v("用户管理")]),r("el-breadcrumb-item",{attrs:{to:{path:"/deviceUser"}}},[e._v("终端用户")]),r("el-breadcrumb-item",[e._v("量子密钥管控")])],1),r("el-card",[r("h2",[e._v("量子密钥操作：")]),r("div",{staticStyle:{display:"flex","justify-content":"flex-start",padding:"40px 30px"}},[r("div",{staticClass:"content",on:{click:e.getKey}},[r("img",{attrs:{src:n("61a4"),alt:""}}),r("el-button",{attrs:{type:"text"}},[e._v("分配额度")])],1),r("div",{staticClass:"content",on:{click:e.exportKey}},[r("img",{attrs:{src:n("e108"),alt:""}}),r("el-button",{attrs:{type:"text"}},[e._v("导出")])],1),r("div",{staticClass:"content",on:{click:e.recallKey}},[r("img",{attrs:{src:n("6e8b"),alt:""}}),r("el-button",{attrs:{type:"text"}},[e._v("撤回")])],1),r("div",{staticClass:"content",on:{click:e.reductionKey}},[r("img",{attrs:{src:n("b84a"),alt:""}}),r("el-button",{attrs:{type:"text"}},[e._v("还原")])],1),r("div",{staticClass:"content",on:{click:e.destoryKey}},[r("img",{attrs:{src:n("261c"),alt:""}}),r("el-button",{attrs:{type:"text"}},[e._v("销毁")])],1)]),r("div",{attrs:{id:"pie"}})]),r("el-dialog",{attrs:{title:e.title,visible:e.keyDialogVisible,width:"520px"},on:{"update:visible":function(t){e.keyDialogVisible=t},close:e.keyDialogClosed}},[r("el-form",{ref:"keyFormRef",attrs:{model:e.keyForm,rules:e.keyFormRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"密钥ID",prop:"keyId"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择"},on:{"visible-change":function(t){return e.oneClick(t)}},model:{value:e.keyForm.keyId,callback:function(t){e.$set(e.keyForm,"keyId",t)},expression:"keyForm.keyId"}},e._l(e.options,(function(e,t){return r("el-option",{key:t,attrs:{label:e,value:e}})})),1)],1),r("el-collapse",{attrs:{accordion:""},on:{change:e.handleChange}},[r("el-collapse-item",{attrs:{name:1,title:"其他"}},[r("el-form-item",{attrs:{prop:"keyIdInput"}},[r("el-input",{attrs:{clearable:"",placeholder:"请输入密钥ID"},model:{value:e.keyForm.keyIdInput,callback:function(t){e.$set(e.keyForm,"keyIdInput","string"===typeof t?t.trim():t)},expression:"keyForm.keyIdInput"}})],1)],1)],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.keyDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick",value:1e3,expression:"1000"}],attrs:{type:"primary"},on:{click:e.keyEnsure}},[e._v("确 定")])],1)],1)],1)},i=[],a=(n("99af"),n("b680"),n("ac1f"),n("1276"),n("96cf"),n("1da1")),s=n("313e"),o={data:function(){var e=function(e,t,n){var r=/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$/;return""===t||r.test(t)?n():void n(new Error("请输入base64格式的字符串"))};return{options:[],title:"",deviceName:this.$route.query.deviceName,keyDialogVisible:!1,keyForm:{keyId:"",keyIdInput:""},keyFormRules:{keyIdInput:[{required:!1,validator:e,trigger:"blur"}]}}},beforeRouteEnter:function(e,t,n){var r=window.sessionStorage.getItem("accountTypeLogin");if("9"!==r)return n("/404");n()},created:function(){this.getUserList()},methods:{getUserList:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("keyInfo/getKeyUsedInfo?ts=".concat((new Date).getTime()),{params:{applicant:e.deviceName}});case 2:if(n=t.sent,r=n.data,0===r.code){t.next=6;break}return t.abrupt("return",e.$message.error(""!==r.msg&&null!==r.msg?r.msg:"请求失败！"));case 6:e.chart(r.data.totalNum,r.data.usedNum);case 7:case"end":return t.stop()}}),t)})))()},handleChange:function(e){""===e&&(this.keyForm.keyIdInput="")},recallKey:function(){this.keyDialogVisible=!0,this.title="撤回"},destoryKey:function(){this.keyDialogVisible=!0,this.title="销毁"},reductionKey:function(){this.keyDialogVisible=!0,this.title="还原"},keyEnsure:function(){var e=this;this.$refs.keyFormRef.validate(function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(n){var r,i,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return");case 2:if(""!==e.keyForm.keyId||""!==e.keyForm.keyIdInput){t.next=4;break}return t.abrupt("return",e.$message.error("请选择密钥ID或者手动输入密钥ID！"));case 4:return r="","撤回"===e.title?r="keyInfo/recallKey":"销毁"===e.title?r="keyInfo/destroyKey":"还原"===e.title&&(r="keyInfo/reductionKey"),i=""===e.keyForm.keyId?e.keyForm.keyIdInput:e.keyForm.keyId,t.next=9,e.$http.post(r,{keyId:i});case 9:if(a=t.sent,s=a.data,0===s.code){t.next=13;break}return t.abrupt("return",e.$message.error(""!==s.msg&&null!==s.msg?s.msg:e.title+"失败！"));case 13:e.$message.success(e.title+"成功！"),e.keyDialogVisible=!1;case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},keyDialogClosed:function(){this.$refs.keyFormRef.resetFields()},oneClick:function(e){!0===e?this.getSelectValue():this.options=[]},getSelectValue:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="","撤回"===e.title?n="keyInfo/getApplicantKeyId":"销毁"===e.title?n="keyInfo/getCanDeleteApplicantKeyId":"还原"===e.title&&(n="keyInfo/getCanReductionApplicantKeyId"),t.next=4,e.$http.post(n,{applicant:e.deviceName});case 4:if(r=t.sent,i=r.data,0===i.code){t.next=8;break}return t.abrupt("return",e.$message.error(null!==i.msg&&""!==i.msg?i.msg:"获取密钥ID失败！"));case 8:e.options=i.data;case 9:case"end":return t.stop()}}),t)})))()},getKey:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$prompt("请输入量子密钥额度","分配额度",{confirmButtonText:"确定",cancelButtonText:"取消",inputValidator:function(e){var t=/^[1-9]\d*$/;return t.test(e)&&e>=1&&e<=2e3?void 0:"请输入1-2000范围内的整数"},inputType:"text"}).catch((function(e){return e}));case 2:if(n=t.sent,"confirm"===n.action){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,e.$http.get("keyInfo/updateKeyLimit?ts=".concat((new Date).getTime()),{params:{applicant:e.deviceName,keyNum:n.value}});case 7:if(r=t.sent,i=r.data,0===i.code){t.next=11;break}return t.abrupt("return",e.$message.error(""!==i.msg&&null!==i.msg?i.msg:"分配额度失败！"));case 11:e.$message.success("分配额度成功！"),e.getUserList();case 13:case"end":return t.stop()}}),t)})))()},exportKey:function(){var e=this,t="keyInfo/exportKeyInfos",n={applicant:this.deviceName};this.$http.post("".concat(t),n,{responseType:"blob"}).then((function(t){var n=decodeURI(t.headers["content-disposition"].split(";")[1].split("=")[1]);e.Global.downloadFile(t.data,n)}))},chart:function(e,t){var n=s["b"](document.getElementById("pie"));n.setOption({title:[{text:"量子密钥额度:".concat(e,"     量子密钥使用数量:").concat(t),left:"50%",top:"85%",textAlign:"center"}],series:[{type:"gauge",radius:"50%",startAngle:90,endAngle:-270,center:["50%","40%"],itemStyle:{color:"#409EFF"},pointer:{show:!1},progress:{show:!0,overlap:!1,roundCap:!0,clip:!1,itemStyle:{borderWidth:1,borderColor:"#409EFF"}},axisLine:{lineStyle:{width:15}},splitLine:{show:!1,distance:0,length:10},axisTick:{show:!1},axisLabel:{show:!1,distance:50},data:[{value:(t/e*100).toFixed(2)}],detail:{valueAnimation:!0,fontSize:18,color:"auto",formatter:"{value}%",offsetCenter:["0%","0%"]}}]}),window.addEventListener("resize",(function(){n.resize()}))}}},l=o,c=(n("7707"),n("2877")),u=Object(c["a"])(l,r,i,!1,null,null,null);t["default"]=u.exports},e108:function(e,t,n){e.exports=n.p+"img/02.af30d613.png"}}]);
//# sourceMappingURL=chunk-2a0a5942.4bef906c.js.map